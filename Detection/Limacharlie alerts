## üõ°Ô∏è Detection with LimaCharlie ‚Äî Sliver Implant & Credential Dumping

In this phase, we pivoted into the LimaCharlie console to validate and detect the Sliver implant and credential dumping activity from our attacker box.

---

### üîç Process Tree & Network Activity

- Navigated to the **Sensors** tab.
- Clicked into the active Windows sensor (my target VM).
- Explored the **Process Tree**, observing legitimate and suspicious processes.
- Located the unsigned Sliver implant binary running from:
  ```
  C:\Users\Administrator\Downloads\[implant_name].exe
  ```
- Used the **Network** tab to trace outbound connections from the Sliver implant to the attacker's C2 server.

> ‚úÖ Legitimate signed binaries are usually benign. But here, our custom payload was unsigned and suspicious by behavior and location.

---

### üìÅ File System Review

- Navigated to `C:\Users\Administrator\Downloads`
- Located the Sliver executable
- Pulled its hash and searched on [VirusTotal](https://www.virustotal.com)
  - Not found ‚Äî expected since it's a freshly compiled payload

---

### üìÖ Timeline Review ‚Äî Implant Execution

- Clicked the **Timeline** tab in the LimaCharlie sensor
- Filtered using:
  ```
  [implant_name]
  ```
- Observed the moment of execution, followed by immediate network activity
- This matched our expected Sliver launch behavior

---

### üß† LSASS Credential Dump Detection

- Refreshed the Timeline view and searched:
  ```
  SENSITIVE_PROCESS_ACCESS
  ```
- Filtered for:
  ```
  rundll32.exe
  ```
- Found event showing access to `lsass.exe` using rundll32 ‚Äî a common credential theft technique

---

### ‚öôÔ∏è Detection & Response (D&R) Rule Setup

Created a custom D&R rule to detect LSASS access via rundll32:

**Detect Section:**
```yaml
event: SENSITIVE_PROCESS_ACCESS
op: and
rules:
  - op: ends with
    path: event/*/TARGET/FILE_PATH
    value: lsass.exe
  - not: true
    op: ends with
    path: event/*/SOURCE/FILE_PATH
    value: wmiprvse.exe
```

**Respond Section:**
```yaml
- action: report
  name: LSASS access
```

---

### üß™ Testing the Rule

- Used the **"Target Event"** and **"Test Event"** buttons to verify that the rule triggered correctly
- Detection matched successfully

---

### üéØ Simulating the Attack Again

Deleted the previous dump:
```
execute cmd.exe /c del C:\\Windows\\Temp\\lsass.dmp
```

Then repeated the attack using:
```
execute rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump [PID] C:\\Windows\\Temp\\lsass.dmp full
```

Confirmed new detection under the **"Detections"** tab:
- Detected rule: `LSASS access`
- Clicked "View Event Timeline" to trace the attack path

---

### üì∏ Screenshots

- **Unsigned Implant in Process Tree**  
  ![Unsigned Implant](../screenshots/implant-process.png)

- **File System ‚Äì Downloads Folder**  
  ![Downloads Folder](../screenshots/downloads-folder.png)

- **Sensitive Process Access Timeline Event**  
  ![Sensitive Access](../screenshots/sensitive-access.png)

- **D&R Rule Created in LimaCharlie**  
  ![DR Rule](../screenshots/detection-rule.png)

- **Detection Alert in LimaCharlie Console**  
  ![Detection Match](../screenshots/detection-alert.png)

